<!DOCTYPE html>
<!--
	Name: Milou Bisseling
	Student number: 10427538
//-->
<html>
    <head>
        <title>TemperatureGraph</title> 
    </head>
    <style>
	h1 {color: black; left; font-family: Arial}
	h2 {color: black; font-family: Arial}
	p {text-align: left; font-family: Arial}
	a {color: black; font-family: Arial}
	canvas {
		text-align: left;
		padding-left: 0;
		padding-right: 0;
		margin-left: 0;
		margin-right: 0;
		display: block;
		width: 800px;
		height: 600px;
		border: 1px solid black;
	}	
	</style>
    <body>
	<h1>Homework week 2</h1>
	<h2>HTML5 Line Graph Using Canvas</h2>
	<p>Milou Bisseling, 10427538</p>
	<p>Average temperature per day in 2016 measured at 'De Bilt'</p>
	<canvas id="canvas" width="800" height="600" style="border: 1px solid black;"></canvas>
	<script type="text/javascript" src="graph.js"></script>
	<a href="https://miloubis.github.io/DataProcessing/Homework/week-2/debilt.html">Datasource</a>    
    </body>

</html>

   		
	</body>

	<textarea id="rawdata">
	20160101,   41
	20160102,   54
	20160103,   69
	20160104,   57
	20160105,   68
	20160106,   26
	20160107,   61
	20160108,   54
	20160109,   56
	20160110,   69
	20160111,   48
	20160112,   58
	20160113,   50
	20160114,   35
	20160115,   24
	20160116,   27
	20160117,  -10
	20160118,  -33
	20160119,  -25
	20160120,   12
	20160121,  -12
	20160122,    9
	20160123,   66
	20160124,   77
	20160125,  107
	20160126,   92
	20160127,  109
	20160128,   67
	20160129,   85
	20160130,   74
	20160131,   68
	20160201,  115
	20160202,   89
	20160203,   50
	20160204,   51
	20160205,   87
	20160206,   94
	20160207,   85
	20160208,   85
	20160209,   53
	20160210,   48
	20160211,   38
	20160212,   27
	20160213,   18
	20160214,   14
	20160215,   23
	20160216,   -3
	20160217,  -13
	20160218,   13
	20160219,   39
	20160220,   82
	20160221,  104
	20160222,   68
	20160223,   43
	20160224,   23
	20160225,   18
	20160226,   21
	20160227,   22
	20160228,   22
	20160229,   13
	20160301,   20
	20160302,   53
	20160303,   39
	20160304,   10
	20160305,    5
	20160306,   30
	20160307,   25
	20160308,   36
	20160309,   44
	20160310,   41
	20160311,   32
	20160312,   31
	20160313,   39
	20160314,   41
	20160315,   46
	20160316,   44
	20160317,   57
	20160318,   52
	20160319,   62
	20160320,   68
	20160321,   72
	20160322,   76
	20160323,   76
	20160324,   79
	20160325,   65
	20160326,   95
	20160327,   91
	20160328,   97
	20160329,   78
	20160330,   81
	20160331,   76
	20160401,   72
	20160402,  101
	20160403,  152
	20160404,  124
	20160405,  106
	20160406,   89
	20160407,   73
	20160408,   67
	20160409,   92
	20160410,  107
	20160411,  132
	20160412,  116
	20160413,   90
	20160414,  106
	20160415,  103
	20160416,   86
	20160417,   62
	20160418,   81
	20160419,   97
	20160420,   86
	20160421,  101
	20160422,   87
	20160423,   62
	20160424,   46
	20160425,   49
	20160426,   48
	20160427,   60
	20160428,   58
	20160429,   74
	20160430,   77
	20160501,   79
	20160502,  115
	20160503,   97
	20160504,   95
	20160505,  128
	20160506,  164
	20160507,  195
	20160508,  201
	20160509,  202
	20160510,  189
	20160511,  204
	20160512,  202
	20160513,  154
	20160514,   89
	20160515,   86
	20160516,   93
	20160517,  123
	20160518,  136
	20160519,  134
	20160520,  137
	20160521,  179
	20160522,  155
	20160523,  120
	20160524,  114
	20160525,  118
	20160526,  137
	20160527,  160
	20160528,  176
	20160529,  172
	20160530,  162
	20160531,  182
	20160601,  192
	20160602,  153
	20160603,  164
	20160604,  201
	20160605,  200
	20160606,  189
	20160607,  201
	20160608,  161
	20160609,  153
	20160610,  164
	20160611,  162
	20160612,  166
	20160613,  159
	20160614,  152
	20160615,  146
	20160616,  157
	20160617,  151
	20160618,  141
	20160619,  153
	20160620,  155
	20160621,  170
	20160622,  201
	20160623,  220
	20160624,  192
	20160625,  154
	20160626,  149
	20160627,  149
	20160628,  167
	20160629,  160
	20160630,  164
	20160701,  169
	20160702,  154
	20160703,  147
	20160704,  170
	20160705,  154
	20160706,  149
	20160707,  168
	20160708,  175
	20160709,  197
	20160710,  213
	20160711,  186
	20160712,  166
	20160713,  145
	20160714,  145
	20160715,  166
	20160716,  197
	20160717,  198
	20160718,  202
	20160719,  228
	20160720,  254
	20160721,  218
	20160722,  211
	20160723,  211
	20160724,  207
	20160725,  182
	20160726,  184
	20160727,  179
	20160728,  190
	20160729,  183
	20160730,  177
	20160731,  170
	20160801,  165
	20160802,  166
	20160803,  190
	20160804,  173
	20160805,  176
	20160806,  164
	20160807,  184
	20160808,  172
	20160809,  144
	20160810,  128
	20160811,  136
	20160812,  189
	20160813,  176
	20160814,  170
	20160815,  161
	20160816,  163
	20160817,  172
	20160818,  177
	20160819,  181
	20160820,  178
	20160821,  167
	20160822,  180
	20160823,  210
	20160824,  228
	20160825,  243
	20160826,  221
	20160827,  216
	20160828,  205
	20160829,  172
	20160830,  162
	20160831,  174
	20160901,  172
	20160902,  166
	20160903,  185
	20160904,  179
	20160905,  173
	20160906,  177
	20160907,  183
	20160908,  196
	20160909,  169
	20160910,  184
	20160911,  185
	20160912,  209
	20160913,  235
	20160914,  230
	20160915,  226
	20160916,  174
	20160917,  173
	20160918,  167
	20160919,  144
	20160920,  145
	20160921,  147
	20160922,  138
	20160923,  136
	20160924,  152
	20160925,  163
	20160926,  135
	20160927,  145
	20160928,  187
	20160929,  159
	20160930,  145
	20161001,  135
	20161002,  121
	20161003,  145
	20161004,  130
	20161005,   98
	20161006,   94
	20161007,  118
	20161008,  110
	20161009,   79
	20161010,   79
	20161011,   80
	20161012,   89
	20161013,   91
	20161014,   99
	20161015,  107
	20161016,  133
	20161017,  121
	20161018,  102
	20161019,   88
	20161020,   85
	20161021,   76
	20161022,   67
	20161023,   48
	20161024,   71
	20161025,   87
	20161026,   95
	20161027,  118
	20161028,  131
	20161029,   96
	20161030,   87
	20161031,   85
	20161101,   81
	20161102,   72
	20161103,   67
	20161104,   76
	20161105,   69
	20161106,   61
	20161107,   42
	20161108,   19
	20161109,   30
	20161110,   40
	20161111,   18
	20161112,   20
	20161113,   27
	20161114,   31
	20161115,  108
	20161116,  119
	20161117,   93
	20161118,   60
	20161119,   58
	20161120,   84
	20161121,  120
	20161122,  110
	20161123,   79
	20161124,   66
	20161125,   33
	20161126,   -1
	20161127,   56
	20161128,   -3
	20161129,  -31
	20161130,   20
	20161201,   79
	20161202,   52
	20161203,   -1
	20161204,  -14
	20161205,  -27
	20161206,    1
	20161207,   63
	20161208,   82
	20161209,   91
	20161210,   78
	20161211,   85
	20161212,   53
	20161213,   66
	20161214,   73
	20161215,   65
	20161216,   54
	20161217,   61
	20161218,   62
	20161219,   43
	20161220,   -6
	20161221,   41
	20161222,   59
	20161223,   60
	20161224,   79
	20161225,  104
	20161226,   83
	20161227,   66
	20161228,   10
	20161229,  -22
	20161230,  -11
	20161231,   18
	</textarea>
	</body>
</html>

<script>
	leftmargin = 80
	rightmargin = 40
	topmargin = 40
	bottommargin = 40
	graphwidth = canvas.width - leftmargin - rightmargin
	graphheight = canvas.height - topmargin - bottommargin

	function parseDate(str) {
	    var y = str.substr(0,4),
	        m = str.substr(4,2),
	        d = str.substr(6,2);
	    return new Date(y,m,d);
	}

	var dateTemp = document.getElementById('rawdata').value.split('\n');


	dates = []
	temps = []
	var millisecondsinoneday = 86400000
	var yearscorrection = 16830.9
	for (i = 0; i < dateTemp.length-1; i++) { 
    	var chunks = dateTemp[i].split(/[\s,]+/);
    	var date = chunks[chunks.length-2];
    	var temp = chunks[chunks.length-1];
    	var day = (parseDate(date).getTime()) / millisecondsinoneday - yearscorrection ;
    	var day = Math.round(day) - 1;
    	dates.push(day);
    	temps.push(parseInt(temp));
    }

	function createTransform(domain, range){

	    var domain_min = domain[0]
	    var domain_max = domain[1]
	    var range_min = range[0]
	    var range_max = range[1]

	    // formulas to calculate the alpha and the beta
	   	var alpha = (range_max - range_min) / (domain_max - domain_min)
	    var beta = range_max - alpha * domain_max

	    // returns the function for the linear transformation (y= a * x + b)
	    return function(x){
	      return alpha * x + beta;
	    }
	}

	tempmin = (Math.min.apply(null, temps));
	tempmax = (Math.max.apply(null, temps));
	datemin = (Math.min.apply(null, dates));
	datemax = (Math.max.apply(null, dates));

	transformtemp = createTransform([300, -50], [bottommargin, graphheight + bottommargin]);
	transformdate = createTransform([datemin, datemax], [leftmargin, graphwidth + leftmargin]);

	transformeddates = []
	transformedtemps = []
	for (var i = 0; i < dates.length; i++) {
		var x = transformdate(dates[i]);
		var y = transformtemp(temps[i]);
		transformeddates.push(x);
		transformedtemps.push(y);
	}

	console.log(tempmin);
	console.log(tempmax);
	console.log(temps);

	console.log(Math.min.apply(null, transformedtemps));
	console.log(Math.max.apply(null, transformedtemps));
	console.log(transformedtemps);
	console.log('1 graden ' +(transformedtemps[63]));
	console.log('2 graden ' +(transformedtemps[60]));
	console.log('3 graden ' +(transformedtemps[65]));
	console.log('5 graden ' +(transformedtemps[12]));
	console.log('9 graden ' +(transformedtemps[103]));
	console.log('20 graden ' +(transformedtemps[156]));



// HIER GA IK DAN TEKENEN ECHT
    window.onload = function() {
	    var canvas = document.getElementById("canvas");
	    var context = canvas.getContext("2d"); 

	    // DRAW X-AXIS
	    context.beginPath();
		context.moveTo(leftmargin, bottommargin + graphheight);
		context.lineTo(leftmargin + graphwidth, bottommargin + graphheight);
		context.stroke();

		// DRAW TICKS ON X-AXIS (X,Y)
		var tick = graphwidth / 12
		for (var i = 0; i < 13; i++) {
			context.beginPath();
			context.moveTo(leftmargin + tick*i, bottommargin + graphheight);
			context.lineTo(leftmargin + tick*i, bottommargin + graphheight + 5);
			context.stroke();
		}

		// DRAW TEMPERATURE LABLES ON X-AXIS
		var tick = graphwidth / 12
		var label = ['','Jan', 'Feb', 'March', 'Apr', 'May', 'June', 'July', 'Aug', 'Sept', 'Okt', 'Nov', 'Dec']
		for (var i = 0; i < 13; i++) {
			context.font = '10pt Arial';
			context.textAlign = "center";
			context.fillText(label[i], leftmargin - 30 + tick*i, topmargin + graphheight + 23);
		}
		
		// DRAW Y-AXIS
		context.beginPath();
		context.moveTo(leftmargin, bottommargin + graphheight);
		context.lineTo(leftmargin, topmargin);
		context.stroke();

		// DRAW TICKS ON Y-AXIS (X,Y)
		var tick = graphheight / 7
		for (var i = 0; i < 8; i++) {
			context.beginPath();
			context.moveTo(leftmargin, bottommargin + graphheight + tick*-i);
			context.lineTo(leftmargin - 5, bottommargin + graphheight + tick*-i);
			context.stroke();
		}

		// DRAW TEMPERATURE LABLES ON Y-AXIS
		var tick = graphheight / 7
		var label = [-5, 0, 5, 10, 15, 20, 25, 30]
		for (var i = 0; i < 13; i++) {
			context.font = '10pt Arial';
			context.textAlign = "center";
			context.fillText(label[i], leftmargin - 20, topmargin + 5 + graphheight - tick*i);
		}

	    // PLOT GRAPH
	    context.beginPath();
        for (var i = 0; i < temps.length; i++) {
        	context.lineTo(transformeddates[i], transformedtemps[i]);
        	context.stroke();
        } 
        context.closePath;

	 	// TITLES
		context.font = '18pt Arial';
		context.textAlign = "left";

		//Title
		context.fillText('Average Temperature De Bilt (NL) 2016', (graphwidth/2), 50);

		//Y-axis text
		context.save();
		context.rotate(-Math.PI / 2);
		context.font = '14pt Arial';
		context.fillText('Temperature (Celsius)', 300 * -1, 30);
		context.restore();
 
	    
	}

</script>
